
<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>UIC Assist</title>
        <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.css" rel="stylesheet">
        
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
        <link rel="stylesheet" href="css/material-components.css">
            <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"></script>
      
      
     
    
        <style>
            .hidden {display:none;}
            body {margin: 0;}
            h1 {padding-top:16px;}
            a.material-icons {text-decoration: none;}
            .screen {padding-left: 16px;}
        </style>
    </head>
    <body class="mdc-typography">
      
		<template id="MDCCard">
			<div class="mdc-card">
				<section class="mdc-card__media"></section>
				<section class="mdc-card__primary">
					<h1 class="mdc-card__title mdc-card__title--large">Title goes here</h1>
					<h2 class="mdc-card__subtitle">Subtitle here</h2>
				</section>
				<section class="mdc-card__supporting-text">
				Lorem ipsum dolor sit amet, consectetur adipisicing elit. Molestias, dolore modi distinctio recusandae, laudantium nulla quidem odio maiores exercitationem odit doloremque laboriosam, cum quos obcaecati officiis repellat perspiciatis sequi omnis.
				</section>
				<section class="mdc-card__actions">
					<button class="mdc-button mdc-button--compact mdc-card__action">Action 1</button>
					<button class="mdc-button mdc-button--compact mdc-card__action">Action 2</button>
				</section>
			</div>
		</template>
		
		
        <header class="mdc-toolbar mdc-toolbar--fixed demo-toolbar">
              <div class="mdc-top-app-bar__row">
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                  <a href="#" class="material-icons mdc-top-app-bar__navigation-icon">menu</a>
                  <span class="mdc-top-app-bar__title">UIC Assist</span>
                </section>
              </div>
            </header>
        
        
        <main>
        <div class="mdc-toolbar-fixed-adjust">
          <div class="">
            <div class="screen hidden" id="home">
              
                <h1>Visuilations for UIC Classes</h1>
                <p>Want to see how a class performed last semester? A Professors Grade distribution?</p>
                <p>Click Below to do search</p>
                <button  class="mdc-button mdc-button--raised" id="doSearch">Do Search</button>
                
                <h1>What is this Visualization?</h1>
                <p>Using publically accessable data this website allows you to quickly and eaisly search through publically accesable data to get a better handle on courses and professors here at UIC.</p>
					      <p>If you are intrested in where this data comes from or want to download the data yourself please visit the about page!</p>
					
					      <h1>You Can Search By</h1>
					      
                <ul>
                  <li>Class</li>
                  <li>Department</li>
                </ul>		
                
                <div id="chart_div"></div>

            </div>
            
            <div class="screen hidden" id="search">
		  <div class="mdl-layout__tab-panel is-active" id="one" align="center">
          <!-- Simple Textfield -->
          <div id="searchField">
          <h4>Search by Class!</h4>
				<div class="mdc-text-field" data-mdc-auto-init="MDCTextField">
				  <input type="text" id="className" class="mdc-text-field__input">
				  <label for="className" class="mdc-floating-label">Class Name</label>
				  <div class="mdc-line-ripple"></div>
				</div>
				<p class="mdc-text-field-helper-text" aria-hidden="false">
				  Enter in format "CS 109" or simply use the Department Abrivation "CS" ect.
				</p>    
				<button class="mdc-button mdc-button--raised" id="classSearch">
				  Search by Class
				</button>
			</div>
			<div id="searchClassResultCards">

			</div>
			</div>          	          
              </div>
            
            
            
            <div class="screen hidden" id="list">
                <h1>Results</h1>
                <ul id="resultList" class="mdc-list mdc-list--two-line mdc-list--avatar-list demo-list demo-list--with-avatars demo-list--icon-placeholders">
              <li id="template" class="mdc-list-item hidden">
                <span class="mdc-list-item__graphic" role="presentation">
                  <i class="material-icons" aria-hidden="true">folder</i>
                </span>
                <span class="mdc-list-item__text">
                  Photos
                  <span class="mdc-list-item__secondary-text">Jan 9, 2014</span>
                </span>
                <a href="#" target="_blank" class="mdc-list-item__meta material-icons" aria-label="View more information" title="More info">
                  cloud-circle</a>
              </li>

            </ul>
                
                
                </div>
            <div class="mdc-layout-grid__cell screen hidden" id="map">
                <h1>Map</h1></div>
            <div class="mdc-layout-grid__cell screen hidden" id="about">
                <h1>About</h1></div>
          </div>
        </div>
        </main>

        <aside class="mdc-drawer mdc-drawer--temporary mdc-typography" data-mdc-auto-init="MDCTemporaryDrawer">
          <nav class="mdc-drawer__drawer">
            <header class="mdc-drawer__header">
              <div class="mdc-drawer__header-content">
                Asteroid Search
              </div>
            </header>
            <nav id="icon-with-text-demo" class="mdc-drawer__content mdc-list">
              <a class="mdc-list-item mdc-list-item--activated" href="#" data-screen="search">
                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">home</i>Home
              </a>
              <a class="mdc-list-item mdc-list-item--activated" href="#" data-screen="search">
                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">search</i>Search
              </a>
              <a class="mdc-list-item" href="#" data-screen="list">
                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">stars</i>Other
              </a>
              <a class="mdc-list-item" href="#" data-screen="map">
                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">map</i>Map
              </a>
            </nav>
          </nav>
        </aside>


        
        <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.js"></script>
    
    
        <script>
             window.mdc.autoInit();
              
              $("#doSearch").on("click", showsearch);
              $("#classSearch").on("click", searchByClass);
              
              function showsearch()
              {
                showScreen("search")
              }
              
          		 function Class(name, a, b, c, d, f, total, ind, sem, nam){
                this.className = name;
                this.As = a;
                this.Bs =b;
                this.Cs = c;
                this.Ds = d;
                this.Fs = f;
                this.total = total;
                this.index = ind;
                this.semesters = sem;
                this.courseName = nam;
              }
                    
              
                function searchByClass()
  {
  	//console.log("In Function");
  	//get the search paramater
  	var searchParam = $("#className").val();
  	//console.log(searchParam);
  	//split course name and number
  	var split = searchParam.split(" ");
  	var cName = split[0];
  	var cNumber = split[1];
  	
  	var filter;
  	//Test if name was entered
  	if(cName != null)
  	{
  		var filter = "CRS_SUBJ_CD=" + cName.toUpperCase();
  		//console.log(cName);
  	}
  	//Test if number is entered
  	if(cNumber != null && cNumber != "")
  	{
  		filter = filter + "&CRS_NBR=" + cNumber;
  	}
  	//console.log(filter);
  	//Check if the filter paramater is empty before doing the search
  	if(filter != null)
  	{
  		 var webAppUrl = 'https://script.google.com/macros/s/AKfycbxJmeT8MT2W5C5jPXII_OdLRgY1BDXk5APQ_iXWEVGMUrfdQvA4/exec?';
  		 
  		 var sheet = "Grades";
  		 
  		 var url = webAppUrl + "dataset=" + sheet + "&" + filter;
  		 
  		 console.log(url);
  		 
  		 var oo = new Object();
  		 
  		  $.ajax({
    type: 'GET',
    url: url,
    async: false,
    jsonpCallback: 'callback',
    //contentType: "application/json",
    dataType: 'jsonp',
    success: function(json) {
      
      $.each(json, function(i, entry) {
       
       //for each class create an object that can hold the paramater
       if(oo[entry.CRS_SUBJ_CD + entry.CRS_NBR] != null)
       {
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR]["As"] += entry.A;
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR]["Bs"] += entry.A;
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR]["Cs"] += entry.A;
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR]["Ds"] += entry.A;
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR]["Fs"] += entry.A;
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR]["total"] += entry.Grade_Regs;
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR]["index"] += 1;
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR]["semesters"] += ", " + entry.Term;
         
       }
       else
       {
         oo[entry.CRS_SUBJ_CD + entry.CRS_NBR] = new Class((entry.CRS_SUBJ_CD +  " " + entry.CRS_NBR), entry.A, entry.B, entry.C, entry.D, entry.F, entry.Grade_Regs, 1, entry.Term, entry.CRS_TITLE);
       }
       
      });
      //console.log(oo);
      console.log("done with search");
      document.querySelector("#searchClassResultCards").innerHTML = "";
      for (var oneclass in oo) {
        //console.log("loop");
        var obj = oo[oneclass];
        //console.log(obj);
        //console.log(obj["As"] + "[]");
        //console.log(obj.As + ".");
        
        var card = document.querySelector('#MDCCard');
        var element = card.content.querySelector(".mdc-card__title");
        element.textContent = obj["className"];
        var element = card.content.querySelector(".mdc-card__subtitle");
        element.textContent = obj["courseName"];
        var element = card.content.querySelector(".mdc-card__supporting-text");
        element.textContent = obj["courseName"] + " Has been taught for a total of " + obj["index"] + " semesters in this dataset (" + obj["semesters"] + ") to a total of " + obj["total"] + " students";
        
        
        
        var loc = document.querySelector("#searchClassResultCards");
        var clone = document.importNode(card.content, true);
        loc.appendChild(clone);
        
        
      }   
      console.log("done")
      //Loop through all objects and create Cards
      
    },
    error: function(e) {
      console.log(e.message);
    }
  });
  	}
  }
              
              
             let drawer = new mdc.drawer.MDCTemporaryDrawer(document.querySelector('.mdc-drawer--temporary'));
            
            document.querySelector('.mdc-top-app-bar__navigation-icon').addEventListener('click', () => drawer.open = true);
            
            var drawerLinks = document.querySelectorAll('.mdc-list-item');
            
             for (var i = 0; i < drawerLinks.length; i++) {
            
                 drawerLinks[i].addEventListener('click', (e) => {
    
                     var screen;
                     var attributes = e.target.attributes;
                     
                     for (var i = 0; i < attributes.length; i++) {
                      console.log(attributes[i].name,attributes[i].value);
                      if (attributes[i].name =="data-screen") {
                          screen = attributes[i].value;
                      }
                      }
                     drawer.open = false;
    
                     showScreen(screen)
                });
             }
            
            showScreen("home");
            
            function showScreen(id) {
                console.log(id);
                var screens = document.querySelectorAll(".screen");
                for (var i = 0; i < screens.length; i++) {
                    screens[i].classList.add("hidden");
                }
                
                document.querySelector("#" + id).classList.remove("hidden");
            }

        </script>
    
    

  </body>
</html>